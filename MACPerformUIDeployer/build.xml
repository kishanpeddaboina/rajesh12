<?xml version="1.0" encoding="windows-1252" ?>
<!--Ant buildfile generated by Oracle JDeveloper-->

<project xmlns="antlib:org.apache.tools.ant" name="MACPerformWorkTaskUI" >
  <property environment="env"/>
  <property file="build.properties"/>

  
    <echo message="LACA_JDEV_INST_ROOT=${env.LACA_JDEV_INST_ROOT}"></echo>
    <echo message="LACA_JDEV_WS_ROOT=${env.LACA_JDEV_WS_ROOT}"></echo>
    <echo message="LACA_ENV_NAME=${env.LACA_ENV_NAME}"></echo>
    <echo message="adminUrl=${adminURL}"></echo>
    <echo message="oracle.jdeveloper.home=${oracle.jdeveloper.home}"></echo>
    <echo message="oracle.jdeveloper.workspace.dir=${oracle.jdeveloper.workspace.dir}"></echo>
 
    
    <tstamp/>
    <condition property="isWindows" value="true" else="false">
        <os family="windows"/>
    </condition>
    <condition property="isLinux" value="true" else="false">
        <os family="unix"/>
    </condition>
    <condition property="oracle.jdeveloper.ojdeploy.path" value="${oracle.jdeveloper.home}/jdev/bin/ojdeploy.exe"
               else="${oracle.jdeveloper.home}/jdev/bin/ojdeploy">
        <os family="windows"/>
    </condition>
    <condition property="oracle.jdeveloper.wlst.dir"
               value="${env.LACA_JDEV_INST_ROOT}/oracle_common/common/bin/wlst.cmd"
               else="${env.LACA_JDEV_INST_ROOT}/oracle_common/common/bin/wlst.sh">
        <os family="windows"/>
    </condition>
    <echo message="isWindows=${isWindows}"></echo>
    <echo message="isLinux=${isLinux}"></echo>
    <echo message="oracle.jdeveloper.ojdeploy.path=${oracle.jdeveloper.ant.library}"></echo>
    <echo message="oracle.jdeveloper.wlst.dir=${oracle.jdeveloper.wlst.dir}"></echo>
    <!-- define the ojdeploy ant task -->
      <taskdef name="ojdeploy" classname="oracle.jdeveloper.deploy.ant.OJDeployAntTask" uri="oraclelib:OJDeployAntTask"
             classpath="${oracle.jdeveloper.ant.library}"/>
             
             
    
    <target name="clean">
        <echo message="cleaning up dirs "/>
        <echo message="        ${oracle.jdeveloper.workspace.path}"/>    
        <delete includeemptydirs="true">
            <fileset dir="${oracle.jdeveloper.workspace.path}" includes="**/deploy/**/*"/>
            <fileset dir="${oracle.jdeveloper.workspace.path}" includes="**/classes/**/*"/>
        </delete>
        <echo message="clean done"/>
    </target>
             
  <target name="build_app" description="Deploy JDeveloper profiles" depends="clean, build_AmpCommon">
   <echo message="copying connections.xml and hwtaskflow file for ${env.LACA_ENV_NAME} "/>
  <copy file="${oracle.jdeveloper.workspace.deployer.path}/build/connections_${env.LACA_ENV_NAME}.xml" tofile="${oracle.jdeveloper.workspace.path}/.adf/META-INF/connections.xml" overwrite="true" />
  
 <!-- <copy file="${oracle.jdeveloper.workspace.path}/.adf/META-INF/adf-config.xml" tofile="${oracle.jdeveloper.workspace.path}/.adf/META-INF/adf-config_mds.xml" overwrite="true" />
  
  <copy file="${oracle.jdeveloper.workspace.deployer.path}/build/adf-config_nomds.xml" tofile="${oracle.jdeveloper.workspace.path}/.adf/META-INF/adf-config.xml" overwrite="true" /> -->
  
  
  <copy file="${oracle.jdeveloper.workspace.view.path}/adfmsrc/hwtaskflow_${env.LACA_ENV_NAME}.xml" tofile="${oracle.jdeveloper.workspace.view.path}/adfmsrc/hwtaskflow.xml" overwrite="true" />
   <echo message="done copying connections.xml and hwtaskflow file for ${env.LACA_ENV_NAME} "/>
   <echo message="Updating Manifest file "/>
   <manifest file="${oracle.jdeveloper.workspace.path}/src/META-INF/MANIFEST.MF" mode="update">
   <attribute name="Weblogic-Application-Version" value="${appversion}"/>
   </manifest>
   <echo message="Done Updating Manifest file "/>
    <echo message="building ear.... "/>
    <ora:ojdeploy xmlns:ora="oraclelib:OJDeployAntTask" executable="${oracle.jdeveloper.ojdeploy.path}"
                  ora:buildscript="${oracle.jdeveloper.deploy.dir}/ojdeploy-build.xml"
                  ora:statuslog="${oracle.jdeveloper.deploy.dir}/ojdeploy-statuslog.xml">
      <ora:deploy>
        <ora:parameter name="workspace" value="${oracle.jdeveloper.workspace.path.file}"/>
        <ora:parameter name="profile" value="${oracle.jdeveloper.deploy.profile.name}"/>
        <ora:parameter name="nocompile" value="false"/>
        <ora:parameter name="outputfile" value="${oracle.jdeveloper.deploy.outputfile}"/>
      </ora:deploy>
    </ora:ojdeploy>
    <!--<copy file="${oracle.jdeveloper.workspace.path}/.adf/META-INF/adf-config_mds.xml" tofile="${oracle.jdeveloper.workspace.path}/.adf/META-INF/adf-config.xml" overwrite="true" /> -->
    <echo message="ear is built .... "/>
  </target>
  
  
  
  
    <target name="deploy" depends="build_app">
    <taskdef name="wldeploy" classname="weblogic.ant.taskdefs.management.WLDeploy">
        <classpath>
            <pathelement location="${oracle.jdeveloper.wldeploy.library}"/>
        </classpath>
    </taskdef>
     <wldeploy action="undeploy" name="${oracle.jdeveloper.datacapture.ear.name}" failonerror="false" user="${user}"
                  password="${password}" verbose="true" adminurl="${adminURL}" targets="${target}"/>
        <wldeploy action="deploy" name="${oracle.jdeveloper.datacapture.ear.name}"
                  source="${oracle.jdeveloper.datacapture.ear.src}" library="false" remote="${remote}" upload="${upload}"
                  failonerror="true" user="${user}" password="${password}" verbose="true" adminurl="${adminURL}"
                  targets="${target}"/>
        <echo message="deploy_MACPerformTaskUI is done"/>
    </target>




 <target name="build_AmpEnterpriseUtils">
        
        <ora:ojdeploy xmlns:ora="oraclelib:OJDeployAntTask" executable="${oracle.jdeveloper.ojdeploy.path}"
                      failonerror="true" ora:buildscript="${oracle.jdeveloper.deploy.dir}/ojdeploy-build.xml"
                      ora:statuslog="${oracle.jdeveloper.deploy.dir}/ojdeploy-statuslog.xml">
            <ora:deploy>
                <ora:parameter name="workspace" value="${oracle.jdeveloper.ampent.workspace.path}"/>
                <ora:parameter name="project" value="${oracle.jdeveloper.ampent.project}"/>
                <ora:parameter name="profile" value="${oracle.jdeveloper.ampent.profile}"/>
            </ora:deploy>
        </ora:ojdeploy>
        <echo message="build_AmpEnterpriseUtils done"/>
    </target>
    
    <target name="build_AmpProxyStubs" depends="build_AmpEnterpriseUtils">
        
        <ora:ojdeploy xmlns:ora="oraclelib:OJDeployAntTask" executable="${oracle.jdeveloper.ojdeploy.path}"
                      failonerror="true" ora:buildscript="${oracle.jdeveloper.deploy.dir}/ojdeploy-build.xml"
                      ora:statuslog="${oracle.jdeveloper.deploy.dir}/ojdeploy-statuslog.xml">
            <ora:deploy>
                <ora:parameter name="workspace" value="${oracle.jdeveloper.ampproxy.workspace.path}"/>
                <ora:parameter name="project" value="${oracle.jdeveloper.ampproxy.project}"/>
                <ora:parameter name="profile" value="${oracle.jdeveloper.ampproxy.profile}"/>
            </ora:deploy>
        </ora:ojdeploy>
        <echo message="build_AmpProxyStubs (with build_AmpEnterpriseUtils)  done"/>
    </target>
    
    <target name="build_AmpCommon" depends="cleanlib,build_AmpProxyStubs">
        
        <ora:ojdeploy xmlns:ora="oraclelib:OJDeployAntTask" executable="${oracle.jdeveloper.ojdeploy.path}"
                      failonerror="true" ora:buildscript="${oracle.jdeveloper.deploy.dir}/ojdeploy-build.xml"
                      ora:statuslog="${oracle.jdeveloper.deploy.dir}/ojdeploy-statuslog.xml">
            <ora:deploy>
                <ora:parameter name="workspace" value="${oracle.jdeveloper.ampcommon.workspace.path}"/>
                <ora:parameter name="project" value="${oracle.jdeveloper.ampcommon.project}"/>
                <ora:parameter name="profile" value="${oracle.jdeveloper.ampcommon.profile}"/>
            </ora:deploy>
        </ora:ojdeploy>
        <echo message="build_AmpCommon done"/>
    </target>
    
    <target name="cleanlib">
        <echo message="cleaning up dirs "/>
        <echo message="        ${oracle.jdeveloper.workspace.wcp.dir}"/>
        <echo message="        ${oracle.jdeveloper.amp.module.dir}"/>        
        <delete includeemptydirs="true">
            <fileset dir="${oracle.jdeveloper.workspace.wcp.dir}" includes="**/deploy/**/*"/>
            <fileset dir="${oracle.jdeveloper.workspace.wcp.dir}" includes="**/classes/**/*"/>
            <fileset dir="${oracle.jdeveloper.amp.module.dir}" includes="*"/>
        </delete>
        <echo message="clean done"/>
    </target>
    
   
    
</project>

